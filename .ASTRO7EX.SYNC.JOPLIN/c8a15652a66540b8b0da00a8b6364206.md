id: c8a15652a66540b8b0da00a8b6364206
parent_id: 
item_type: 1
item_id: 911bd0cec4484f6da09927a6f6495f71
item_updated_time: 1764786487687
title_diff: "[{\"diffs\":[[1,\"üìòDevelopment Workflow  Atomic Astrology Database ‚Äî \"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":52}]"
body_diff: "[{\"diffs\":[[1,\"\\\n# üìò Atomic Astrology Database ‚Äî Development Workflow\\\n\\\n**Category:** Data Architecture / System Design  \\\n**Focus:** Building the DB as infrastructure (not character-first)\\\n\\\n---\\\n\\\n## üìë Table of Contents\\\n\\\n1. [Objective](#1-objective)  \\\n2. [Mental Model](#2-mental-model)  \\\n3. [PSTO ‚Äî Policy / Strategy / Tactics / Operations](#3-psto--policy--strategy--tactics--operations)  \\\n   - [3.1 Policy](#31-policy)  \\\n   - [3.2 Strategy](#32-strategy)  \\\n   - [3.3 Tactics](#33-tactics)  \\\n   - [3.4 Operations](#34-operations)  \\\n4. [Phase 0 ‚Äî Stack & Ground Rules](#4-phase-0--stack--ground-rules)  \\\n   - [4.1 DB Engine](#41-db-engine)  \\\n   - [4.2 Tooling](#42-tooling)  \\\n   - [4.3 Conventions](#43-conventions)  \\\n5. [Phase 1 ‚Äî Core Meta Schema](#5-phase-1--core-meta-schema)  \\\n   - [5.1 Tables to Build First](#51-tables-to-build-first)  \\\n   - [5.2 Minimal DDL Skeleton](#52-minimal-ddl-skeleton)  \\\n6. [Phase 2 ‚Äî Seed Domains, Subsystems, Atomic Variables](#6-phase-2--seed-domains-subsystems-atomic-variables)  \\\n   - [6.1 Seeding Strategy](#61-seeding-strategy)  \\\n   - [6.2 Sanity Checks](#62-sanity-checks)  \\\n7. [Phase 3 ‚Äî Add Overlay Models (Meta Only)](#7-phase-3--add-overlay-models-meta-only)  \\\n   - [7.1 Register Models](#71-register-models)  \\\n   - [7.2 Register Dimensions](#72-register-dimensions)  \\\n8. [Phase 4 ‚Äî Wire Astro Variables to Models](#8-phase-4--wire-astro-variables-to-models)  \\\n9. [Phase 5 ‚Äî Characters, Charts & Instance Layer](#9-phase-5--characters-charts--instance-layer)  \\\n   - [9.1 Core Instance Tables](#91-core-instance-tables)  \\\n   - [9.2 Overlay & Atomic Instance Tables](#92-overlay--atomic-instance-tables)  \\\n10. [Phase 6 ‚Äî Dev Workflows & Core Queries](#10-phase-6--dev-workflows--core-queries)  \\\n    - [10.1 Must-Have Queries](#101-must-have-queries)  \\\n11. [Phase 7 ‚Äî Iteration Strategy](#11-phase-7--iteration-strategy)  \\\n12. [One-Week Implementation Plan](#12-one-week-implementation-plan)\\\n\\\n---\\\n\\\n## 1. Objective\\\n\\\n- Build a **universal astrology + psychology database** that:\\\n  - Stores **meta definitions** (domains, subsystems, atomic variables, overlay models).\\\n  - Stores **instance data** (characters, charts, overlay scores, atomic values).\\\n  - Lets you attach external models (Big Five, Enneagram, Attachment, etc.) to astro variables in a clean, scalable way.\\\n\\\nThis is **infrastructure**, not story. The goal is a stable schema you can slam thousands of characters into later.\\\n\\\n---\\\n\\\n## 2. Mental Model\\\n\\\n- **Meta vs Instance:**\\\n  - **META** = dictionary / grammar:\\\n    - `domains`, `subsystems`, `atomic_variable_def`, `overlay_model`, `overlay_model_dimension`, `atomic_variable_overlay`.\\\n  - **INSTANCE** = actual data:\\\n    - `characters`, `charts`, `overlay_model_profile`, `overlay_model_dimension_value`, `atomic_value`.\\\n\\\n- Think in 3 layers:\\\n  1. **Grammar** ‚Üí table structure + meta rows.\\\n  2. **Dictionary** ‚Üí all your atomic var definitions + model dimensions.\\\n  3. **Sentences** ‚Üí concrete character charts and values.\\\n\\\nYou do **1 & 2 first**. Characters come later.\\\n\\\n---\\\n\\\n## 3. PSTO ‚Äî Policy / Strategy / Tactics / Operations\\\n\\\n### 3.1 Policy\\\n\\\n**High-level rules this system must obey:**\\\n\\\n- **P1 ‚Äî Meta First, Instance Second**  \\\n  The database is built as a **meta engine**, not a character toy. All design decisions prioritize clean separation between:\\\n  - Meta tables (definitions, schemas, wiring).\\\n  - Instance tables (per-character, per-chart data).\\\n- **P2 ‚Äî Schema Stability Over Vibe**  \\\n  Structural changes must be deliberate and migration-based. No ‚Äúfreelance‚Äù edits in the live DB.\\\n- **P3 ‚Äî Extensibility Over Perfection**  \\\n  It‚Äôs better to be able to *add* a new model or variable than to constantly rename or reshape old ones.\\\n- **P4 ‚Äî One Source of Truth**  \\\n  Every concept (atomic variable, model, dimension) has exactly **one canonical definition** in meta tables.\\\n- **P5 ‚Äî Readability for Future You**  \\\n  Names and structure must be clear enough that six months from now, you can read the schema without wanting to die.\\\n\\\n---\\\n\\\n### 3.2 Strategy\\\n\\\n**How we‚Äôre going to achieve the policy-level goals:**\\\n\\\n- **S1 ‚Äî Two-Layer Architecture**\\\n  - Layer 1: **Meta Schema**  \\\n    `domains`, `subsystems`, `atomic_variable_def`, `overlay_model`, `overlay_model_dimension`, `atomic_variable_overlay`.\\\n  - Layer 2: **Instance Data**  \\\n    `characters`, `charts`, `overlay_model_profile`, `overlay_model_dimension_value`, `atomic_value`.\\\n- **S2 ‚Äî Phased Build-Out**\\\n  1. Lock core meta schema.\\\n  2. Populate astro variable definitions.\\\n  3. Add overlay models + dimensions.\\\n  4. Wire variables ‚Üî models.\\\n  5. Only then create characters/charts and start using the system.\\\n- **S3 ‚Äî Migrations as Gatekeepers**\\\n  - All schema evolution goes through migrations.\\\n  - No silent, manual structural edits; everything is traceable.\\\n- **S4 ‚Äî Test with Synthetic Characters**\\\n  - Use 1‚Äì2 ‚Äúdummy‚Äù characters and charts to validate flows before loading real narrative data.\\\n- **S5 ‚Äî Query-Driven Validation**\\\n  - Define a small set of **canonical queries** that must always work.  \\\n  - When schema changes, these queries are regression tests.\\\n\\\n---\\\n\\\n### 3.3 Tactics\\\n\\\n**Concrete design choices that make the strategy real:**\\\n\\\n- **T1 ‚Äî Tech Stack**\\\n  - Use **PostgreSQL** as the primary engine.\\\n  - Use **DBBeaver** for visual inspection and ad-hoc queries.\\\n- **T2 ‚Äî Naming Conventions**\\\n  - Tables in `snake_case_plural`: `atomic_variable_def`, `overlay_model_profile`.\\\n  - Primary keys: `<table>_id`: `character_id`, `model_id`.\\\n  - Code fields in `UPPER_SNAKE`: `SUN_IDENTITY_AXIS`, `BIG_FIVE`.\\\n- **T3 ‚Äî Hard Separation of Concerns**\\\n  - No instance data sneaks into meta tables.\\\n  - No definitional info (like descriptions of `SUN_IDENTITY_AXIS`) lives in instance tables.\\\n- **T4 ‚Äî CSV ‚Üí DB for Bulk Meta**\\\n  - Maintain atomic variable definitions in a **CSV/markdown list** that can be imported into `atomic_variable_def`.\\\n  - Same for model dimensions.\\\n- **T5 ‚Äî JSON for Complex Values**\\\n  - Where needed, use `value_json` for rich, structured data (e.g., complex scores) but keep basic stuff in `value_text` / `value_numeric`.\\\n- **T6 ‚Äî Minimal Test Character Set**\\\n  - Start with:\\\n    - 1 character,\\\n    - 1 natal chart,\\\n    - 2‚Äì3 overlay models,\\\n    - a small slice of atomic variables (Sun/Moon/Asc).\\\n  - Only expand when the flow from meta ‚Üí overlay ‚Üí atomic value is proven.\\\n\\\n---\\\n\\\n### 3.4 Operations\\\n\\\n**Day-to-day behaviors, step-by-step:**\\\n\\\n- **O1 ‚Äî Schema Change Workflow**\\\n  1. Edit migration file (add/alter tables or columns).\\\n  2. Run migration against dev DB.\\\n  3. Run canonical queries to confirm nothing broke.\\\n  4. Apply migration to main DB.\\\n- **O2 ‚Äî Meta Seeding Workflow**\\\n  1. Update `domains`, `subsystems`, `atomic_variable_def`, `overlay_model`, `overlay_model_dimension` in CSV/markdown.\\\n  2. Import/update via script or DBBeaver.\\\n  3. Run checks:\\\n     - Count of variables per subsystem.\\\n     - Duplicate `var_code` / `model_code` checks.\\\n- **O3 ‚Äî Wiring Workflow (Atomic ‚Üî Overlay)**\\\n  1. Decide which models influence a given atomic variable.\\\n  2. Insert rows into `atomic_variable_overlay` with `role` + `weight`.\\\n  3. Run a quick query to verify the mapping.\\\n- **O4 ‚Äî Character Onboarding Workflow**\\\n  1. Insert `characters` row.\\\n  2. Insert `charts` row linked to that character.\\\n  3. Create `overlay_model_profile` rows for the models you care about.\\\n  4. Insert `overlay_model_dimension_value` rows with scores or labels.\\\n  5. Generate `atomic_value` rows based on your logic (manual or via code).\\\n- **O5 ‚Äî Validation & Maintenance**\\\n  - Regularly:\\\n    - Run the core queries (Section 10) as a health check.\\\n    - Compare counts:\\\n      - # of `atomic_variable_def` vs. # of `atomic_value` per chart (coverage).\\\n      - # of `overlay_model_dimension` vs. # of `overlay_model_dimension_value` per profile (completeness).\\\n    - Log major schema changes in a simple changelog file.\\\n\\\n---\\\n\\\n## 4. Phase 0 ‚Äî Stack & Ground Rules\\\n\\\n### 4.1 DB Engine\\\n\\\n- Recommended:\\\n  - **PostgreSQL** if you want a long-term, flexible, JSON-friendly core.\\\n  - **SQLite** only if you want a quick single-file portable prototype.\\\n\\\n- Default assumption: **Postgres**.\\\n\\\n---\\\n\\\n### 4.2 Tooling\\\n\\\n- **DB viewer:** DBBeaver (browse tables, run queries, inspect ERD).\\\n- **Migrations:** pick one and commit to it, e.g.:\\\n  - `Flyway`, `Liquibase`, or\\\n  - ORM-based: `SQLAlchemy + Alembic`, `Prisma`, etc.\\\n\\\nRule:  \\\n- **No manual schema changes in ‚Äúreal‚Äù DB.**  \\\n- All schema edits go through migrations.\\\n\\\n---\\\n\\\n### 4.3 Conventions\\\n\\\n- **Naming:**\\\n  - Tables: `snake_case_plural` ‚Üí `domains`, `subsystems`, `atomic_variable_def`.\\\n  - PKs: `table_singular_id` ‚Üí `domain_id`, `subsystem_id`.\\\n  - Codes: `UPPER_SNAKE` ‚Üí `SUN_IDENTITY_AXIS`, `BIG_FIVE`.\\\n\\\n- **IDs:**\\\n  - Start with `SERIAL` / `BIGINT` primary keys.\\\n  - Add `uuid` later if you really need cross-system IDs.\\\n\\\n- **Separation:**\\\n  - META tables: definitions only.\\\n  - INSTANCE tables: per character/chart data only.\\\n\\\nLock this in: **do not mix meta and instance in the same table.**\\\n\\\n---\\\n\\\n## 5. Phase 1 ‚Äî Core Meta Schema\\\n\\\n### 5.1 Tables to Build First\\\n\\\nCreate these **before touching characters**:\\\n\\\n1. `domains` ‚Äì high-level psycho-astro buckets.  \\\n2. `subsystems` ‚Äì Sun/Moon/Asc/Planets/Houses/etc. mapped to domains.  \\\n3. `atomic_variable_def` ‚Äì all the `SUN_*`, `MOON_*`, `ASC_*`, `H*_` variables.  \\\n4. `overlay_model` ‚Äì Big Five, Enneagram, Attachment, etc.  \\\n5. `overlay_model_dimension` ‚Äì each trait/slider inside those models.\\\n\\\n---\\\n\\\n### 5.2 Minimal DDL Skeleton\\\n\\\nBarebones start (Postgres-flavored):\\\n\\\n```sql\\\nCREATE TABLE domains (\\\n    domain_id        SERIAL PRIMARY KEY,\\\n    domain_code      VARCHAR(64) UNIQUE NOT NULL,\\\n    name             VARCHAR(128) NOT NULL,\\\n    description      TEXT\\\n);\\\n\\\nCREATE TABLE subsystems (\\\n    subsystem_id     SERIAL PRIMARY KEY,\\\n    domain_id        INTEGER NOT NULL REFERENCES domains(domain_id),\\\n    subsystem_code   VARCHAR(64) UNIQUE NOT NULL,\\\n    name             VARCHAR(128) NOT NULL,\\\n    description      TEXT\\\n);\\\n\\\nCREATE TABLE atomic_variable_def (\\\n    atomic_var_id    SERIAL PRIMARY KEY,\\\n    subsystem_id     INTEGER NOT NULL REFERENCES subsystems(subsystem_id),\\\n    var_code         VARCHAR(128) UNIQUE NOT NULL,\\\n    name             VARCHAR(128) NOT NULL,\\\n    description      TEXT,\\\n    data_type        VARCHAR(32) NOT NULL DEFAULT 'text',\\\n    applies_to_level VARCHAR(32) NOT NULL DEFAULT 'both',\\\n    is_core          BOOLEAN NOT NULL DEFAULT TRUE\\\n);\\\n\\\nCREATE TABLE overlay_model (\\\n    model_id         SERIAL PRIMARY KEY,\\\n    domain_id        INTEGER REFERENCES domains(domain_id),\\\n    model_code       VARCHAR(64) UNIQUE NOT NULL,\\\n    name             VARCHAR(128) NOT NULL,\\\n    model_type       VARCHAR(64) NOT NULL,\\\n    description      TEXT\\\n);\\\n\\\nCREATE TABLE overlay_model_dimension (\\\n    dimension_id     SERIAL PRIMARY KEY,\\\n    model_id         INTEGER NOT NULL REFERENCES overlay_model(model_id),\\\n    dimension_code   VARCHAR(64) NOT NULL,\\\n    name             VARCHAR(128) NOT NULL,\\\n    data_type        VARCHAR(32) NOT NULL DEFAULT 'numeric',\\\n    min_value        NUMERIC,\\\n    max_value        NUMERIC,\\\n    enum_options     JSONB,\\\n    UNIQUE (model_id, dimension_code)\\\n);\\\n````\\\n\\\nThis is your **skeleton**. No character data yet.\\\n\\\n---\\\n\\\n## 6. Phase 2 ‚Äî Seed Domains, Subsystems, Atomic Variables\\\n\\\n### 6.1 Seeding Strategy\\\n\\\n1. **Seed `domains`:**\\\n\\\n   * Example set:\\\n\\\n     * `IDENTITY`, `EMOTIONAL`, `COGNITIVE`, `RELATIONAL`, `ACTION`, `GROWTH`, `SHADOW`, `SOCIAL`, `GLOBAL`.\\\n\\\n2. **Seed `subsystems`:**\\\n\\\n   * Map each subsystem to a domain:\\\n\\\n     * `SUN`, `MOON`, `ASC`, `MERCURY`, `VENUS`, `MARS`, `JUPITER`, `SATURN`, `URANUS`, `NEPTUNE`, `PLUTO`.\\\n     * `HOUSES`, `ASPECTS`, `NODES`, `POINTS`, `CHART_SHAPE`, etc.\\\n\\\n3. **Seed `atomic_variable_def`:**\\\n\\\n   * Take your long markdown list of atomic vars:\\\n\\\n     * `SUN_IDENTITY_AXIS`, `SUN_MOTIVATION_VECTOR`, `MOON_NEED_CORE`, `ASC_SURFACE_IMAGE`, `H1_SELF_ARCHETYPE`, etc.\\\n   * Convert to **CSV** and bulk-import via DBBeaver or scripts:\\\n\\\n     * `subsystem_code`, `var_code`, `name`, `description`, `data_type`.\\\n\\\nYou‚Äôre filling the **catalogue**. No scores, no text values yet.\\\n\\\n---\\\n\\\n### 6.2 Sanity Checks\\\n\\\nBy the end of this phase you should be able to:\\\n\\\n* `SELECT * FROM domains;`\\\n  ‚Üí see all your domains.\\\n\\\n* List all subsystem+domain combos:\\\n\\\n  ```sql\\\n  SELECT d.domain_code, s.subsystem_code\\\n  FROM subsystems s\\\n  JOIN domains d ON s.domain_id = d.domain_id;\\\n  ```\\\n\\\n* List all atomic variables for Sun:\\\n\\\n  ```sql\\\n  SELECT s.subsystem_code, avd.var_code, avd.name\\\n  FROM atomic_variable_def avd\\\n  JOIN subsystems s ON avd.subsystem_id = s.subsystem_id\\\n  WHERE s.subsystem_code = 'SUN'\\\n  ORDER BY avd.var_code;\\\n  ```\\\n\\\nIf this isn‚Äôt clean and readable, fix schema now.\\\n\\\n---\\\n\\\n## 7. Phase 3 ‚Äî Add Overlay Models (Meta Only)\\\n\\\nStill no characters. Just wiring models.\\\n\\\n### 7.1 Register Models\\\n\\\nInsert into `overlay_model`:\\\n\\\n* `BIG_FIVE` (domain `IDENTITY`, type `trait`).\\\n* `ENNEAGRAM` (domain `IDENTITY`, type `typology`).\\\n* `ATTACHMENT` (domain `EMOTIONAL`, type `typology`).\\\n* Later: `SHADOW`, `IFS`, `SCHEMA`, `STERNBERG`, `LOVE_LANG`, `T_KILMANN`, `KARPMAN`, `MASLOW`, `SDT`, etc.\\\n\\\nThese rows define **which psychology packs exist** in the system.\\\n\\\n---\\\n\\\n### 7.2 Register Dimensions\\\n\\\nFor each model, define dimensions in `overlay_model_dimension`:\\\n\\\n* **Big Five:**\\\n\\\n  * `O`, `C`, `E`, `A`, `N` (numeric 0‚Äì100).\\\n* **Enneagram:**\\\n\\\n  * `TYPE`, `WING` (text/enums 1‚Äì9).\\\n* **Attachment:**\\\n\\\n  * `STYLE` (enum: `Secure`, `Anxious`, `Avoidant`, `Disorganized`).\\\n\\\nAt this point, still **no character scores**. You‚Äôre just defining sliders.\\\n\\\n---\\\n\\\n## 8. Phase 4 ‚Äî Wire Astro Variables to Models\\\n\\\nCreate the junction table:\\\n\\\n```sql\\\nCREATE TABLE atomic_variable_overlay (\\\n    atomic_var_id  INTEGER NOT NULL REFERENCES atomic_variable_def(atomic_var_id),\\\n    model_id       INTEGER NOT NULL REFERENCES overlay_model(model_id),\\\n    role           VARCHAR(32) NOT NULL DEFAULT 'PRIMARY',\\\n    weight         NUMERIC NOT NULL DEFAULT 1.0,\\\n    notes          TEXT,\\\n    PRIMARY KEY (atomic_var_id, model_id)\\\n);\\\n```\\\n\\\nThen seed rules like:\\\n\\\n* `SUN_IDENTITY_AXIS` ‚Üí `BIG_FIVE` (PRIMARY, 0.7) + `ENNEAGRAM` (SECONDARY, 0.3).\\\n* `SUN_EGO_STYLE` ‚Üí `BIG_FIVE` only.\\\n* `MOON_NEED_CORE` ‚Üí `ATTACHMENT` only.\\\n* Etc, for all relevant atomic vars.\\\n\\\nThis is where you declare:\\\n\\\n> ‚ÄúWhen I compute **this atomic trait**, these **models** are consulted, with these **weights**.‚Äù\\\n\\\nStill zero characters.\\\n\\\n---\\\n\\\n## 9. Phase 5 ‚Äî Characters, Charts & Instance Layer\\\n\\\nOnce meta is stable, add the **instance layer**.\\\n\\\n### 9.1 Core Instance Tables\\\n\\\n```sql\\\nCREATE TABLE characters (\\\n    character_id   SERIAL PRIMARY KEY,\\\n    name           VARCHAR(128) NOT NULL,\\\n    status         VARCHAR(32) NOT NULL DEFAULT 'active',\\\n    notes          TEXT\\\n);\\\n\\\nCREATE TABLE charts (\\\n    chart_id       SERIAL PRIMARY KEY,\\\n    character_id   INTEGER NOT NULL REFERENCES characters(character_id),\\\n    chart_type     VARCHAR(64) NOT NULL,\\\n    datetime_utc   TIMESTAMPTZ,\\\n    location       VARCHAR(256),\\\n    system         VARCHAR(64),\\\n    notes          TEXT\\\n);\\\n```\\\n\\\nGuideline:\\\n\\\n* Use **1‚Äì2 test characters** at first.\\\n* Don‚Äôt treat early characters as canon; they‚Äôre just schema testers.\\\n\\\n---\\\n\\\n### 9.2 Overlay & Atomic Instance Tables\\\n\\\nOverlay profiles & values:\\\n\\\n```sql\\\nCREATE TABLE overlay_model_profile (\\\n    profile_id     SERIAL PRIMARY KEY,\\\n    character_id   INTEGER NOT NULL REFERENCES characters(character_id),\\\n    chart_id       INTEGER REFERENCES charts(chart_id),\\\n    model_id       INTEGER NOT NULL REFERENCES overlay_model(model_id),\\\n    profile_label  VARCHAR(64) NOT NULL,\\\n    notes          TEXT,\\\n    UNIQUE (character_id, chart_id, model_id, profile_label)\\\n);\\\n\\\nCREATE TABLE overlay_model_dimension_value (\\\n    profile_id     INTEGER NOT NULL REFERENCES overlay_model_profile(profile_id),\\\n    dimension_id   INTEGER NOT NULL REFERENCES overlay_model_dimension(dimension_id),\\\n    value_numeric  NUMERIC,\\\n    value_text     VARCHAR(256),\\\n    value_json     JSONB,\\\n    source         VARCHAR(64),\\\n    last_updated   TIMESTAMPTZ DEFAULT NOW(),\\\n    PRIMARY KEY (profile_id, dimension_id)\\\n);\\\n```\\\n\\\nAtomic values per chart:\\\n\\\n```sql\\\nCREATE TABLE atomic_value (\\\n    chart_id       INTEGER NOT NULL REFERENCES charts(chart_id),\\\n    atomic_var_id  INTEGER NOT NULL REFERENCES atomic_variable_def(atomic_var_id),\\\n    value_text     TEXT,\\\n    value_numeric  NUMERIC,\\\n    value_json     JSONB,\\\n    source         VARCHAR(64),\\\n    last_updated   TIMESTAMPTZ DEFAULT NOW(),\\\n    PRIMARY KEY (chart_id, atomic_var_id)\\\n);\\\n```\\\n\\\nThis layer is where **Vivian**, etc. actually get:\\\n\\\n* Big Five scores,\\\n* Enneagram type,\\\n* Attachment style,\\\n* Atomic variable summaries.\\\n\\\n---\\\n\\\n## 10. Phase 6 ‚Äî Dev Workflows & Core Queries\\\n\\\nYou now need **basic dev workflows** to prove the schema is sane.\\\n\\\n### 10.1 Must-Have Queries\\\n\\\n**1. List all atomic variables for a subsystem (e.g. Sun):**\\\n\\\n```sql\\\nSELECT d.domain_code, s.subsystem_code, avd.var_code, avd.name\\\nFROM atomic_variable_def avd\\\nJOIN subsystems s ON avd.subsystem_id = s.subsystem_id\\\nJOIN domains d ON s.domain_id = d.domain_id\\\nWHERE s.subsystem_code = 'SUN'\\\nORDER BY avd.var_code;\\\n```\\\n\\\n**2. For a given atomic variable, list its overlay models:**\\\n\\\n```sql\\\nSELECT avd.var_code, om.model_code, avo.role, avo.weight\\\nFROM atomic_variable_overlay avo\\\nJOIN atomic_variable_def avd ON avo.atomic_var_id = avd.atomic_var_id\\\nJOIN overlay_model om ON avo.model_id = om.model_id\\\nWHERE avd.var_code = 'SUN_IDENTITY_AXIS';\\\n```\\\n\\\n**3. For a given character + chart, show overlay scores:**\\\n\\\n```sql\\\nSELECT c.name,\\\n       om.model_code,\\\n       omd.dimension_code,\\\n       omdv.value_numeric,\\\n       omdv.value_text\\\nFROM overlay_model_dimension_value omdv\\\nJOIN overlay_model_profile omp ON omdv.profile_id = omp.profile_id\\\nJOIN overlay_model_dimension omd ON omdv.dimension_id = omd.dimension_id\\\nJOIN overlay_model om ON omd.model_id = om.model_id\\\nJOIN characters c ON omp.character_id = c.character_id\\\nWHERE c.character_id = 1\\\n  AND omp.chart_id = 1;\\\n```\\\n\\\n**4. Dump all atomic values for a chart:**\\\n\\\n```sql\\\nSELECT c.name,\\\n       ch.chart_id,\\\n       s.subsystem_code,\\\n       avd.var_code,\\\n       av.value_text,\\\n       av.value_numeric\\\nFROM atomic_value av\\\nJOIN charts ch ON av.chart_id = ch.chart_id\\\nJOIN characters c ON ch.character_id = c.character_id\\\nJOIN atomic_variable_def avd ON av.atomic_var_id = avd.atomic_var_id\\\nJOIN subsystems s ON avd.subsystem_id = s.subsystem_id\\\nWHERE ch.chart_id = 1\\\nORDER BY s.subsystem_code, avd.var_code;\\\n```\\\n\\\nIf these don‚Äôt run clean or return sensible data, your design isn‚Äôt ready.\\\n\\\n---\\\n\\\n## 11. Phase 7 ‚Äî Iteration Strategy\\\n\\\nYou‚Äôre going to keep thinking of better ways to slice things. Don‚Äôt wreck the DB every time.\\\n\\\n* **Freeze in bursts:**\\\n\\\n  * For 1‚Äì2 weeks at a time, treat `domains`, `subsystems`, `atomic_variable_def` as **locked**.\\\n  * Make changes via migrations only.\\\n\\\n* **Favor adding over renaming:**\\\n\\\n  * If you want a prettier label, add a `display_name` column instead of changing codes.\\\n\\\n* **Overlay models stay modular:**\\\n\\\n  * If a model bloats, add `*_EXTENDED` variant instead of mutating the original.\\\n\\\n* **Characters are disposable until meta is stable:**\\\n\\\n  * Early characters are test data.\\\n  * Real asset = **meta dictionary & schema**, not first drafts of Vivian.\\\n\\\n---\\\n\\\n## 12. One-Week Implementation Plan\\\n\\\n**Day 1‚Äì2: Core Meta**\\\n\\\n* Stand up Postgres + DBBeaver.\\\n* Create:\\\n\\\n  * `domains`, `subsystems`, `atomic_variable_def`.\\\n* Seed:\\\n\\\n  * All `domains`.\\\n  * Core `subsystems` (Sun‚ÄìPluto, Houses, Aspects, Nodes).\\\n  * At least Sun/Moon/Asc atomic vars from your existing list.\\\n\\\n**Day 3‚Äì4: Overlay Meta**\\\n\\\n* Create:\\\n\\\n  * `overlay_model`, `overlay_model_dimension`, `atomic_variable_overlay`.\\\n* Seed:\\\n\\\n  * `BIG_FIVE`, `ENNEAGRAM`, `ATTACHMENT`, plus any others you‚Äôre sure about.\\\n* Wire:\\\n\\\n  * All `SUN_*` and `MOON_*` variables to relevant models with roles/weights.\\\n\\\n**Day 5: Instance Skeleton**\\\n\\\n* Create:\\\n\\\n  * `characters`, `charts`, `overlay_model_profile`, `overlay_model_dimension_value`, `atomic_value`.\\\n* Add:\\\n\\\n  * 1 test character + 1 natal chart.\\\n  * 1 set of overlay scores (e.g., Big Five + Enneagram + Attachment).\\\n  * 3‚Äì5 `atomic_value` records generated manually as a proof-of-concept.\\\n\\\n**Day 6: Query & Debug**\\\n\\\n* Run the **four core queries**.\\\n* Fix:\\\n\\\n  * Bad joins, missing FKs, naming screwups.\\\n* Confirm:\\\n\\\n  * You can move from character ‚Üí chart ‚Üí overlay scores ‚Üí atomic values smoothly.\\\n\\\n**Day 7: Admin + Refinement**\\\n\\\n* Build tiny admin flows:\\\n\\\n  * SQL scripts / CLI to:\\\n\\\n    * Add a new atomic variable definition.\\\n    * Attach overlay models to that variable.\\\n    * List everything for a given subsystem.\\\n* Once this is painless, scale up:\\\n\\\n  * Add the full variable universe (all planets/houses/aspects).\\\n  * Add more overlay models.\\\n\\\nAt that point, the DB is a **real instrument panel**, not a loose pile of ideas.\\\n\\\n```\\\n```\\\n\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":20779}]"
metadata_diff: {"new":{"id":"911bd0cec4484f6da09927a6f6495f71","parent_id":"1bee78f443a94558b4a4b89a9f2e81f9","latitude":"30.43825590","longitude":"-84.28073290","altitude":"0.0000","author":"","source_url":"","is_todo":0,"todo_due":0,"todo_completed":0,"source":"joplin-desktop","source_application":"net.cozic.joplin-desktop","application_data":"","order":0,"markup_language":1,"is_shared":0,"share_id":"","conflict_original_id":"","master_key_id":"","user_data":"","deleted_time":0},"deleted":[]}
encryption_cipher_text: 
encryption_applied: 0
updated_time: 2025-12-03T18:35:29.574Z
created_time: 2025-12-03T18:35:29.574Z
type_: 13