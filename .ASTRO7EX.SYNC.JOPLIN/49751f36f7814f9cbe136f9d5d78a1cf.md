readme.md

# DIY Mocap & Pipeline Overview (Everything We Covered)

---

## Table of Contents

* [1. QuickMagic — What It Is](#1-quickmagic--what-it-is)
* [2. ARKit (iPhone) — What It Buys You](#2-arkit-iphone--what-it-buys-you)
* [3. “Video of a Video” With ARKit](#3-video-of-a-video-with-arkit)
* [4. Multi-Person Capture](#4-multi-person-capture)
* [5. Apple Watch As Supplement](#5-apple-watch-as-supplement)
* [6. Latency Cheat Sheet](#6-latency-cheat-sheet)
* [7. Base Stations (SteamVR/Vive) Basics](#7-base-stations-steamvrvive-basics)
* [8. Processing Load — Where The Work Actually Happens](#8-processing-load--where-the-work-actually-happens)
* [9. Hybrid: ARKit + Base Stations](#9-hybrid-arkit--base-stations)
* [10. SlimeVR — What It Is & Mixing With Lighthouses](#10-slimevr--what-it-is--mixing-with-lighthouses)
* [11. DIY Lighthouses? (Short Answer: No)](#11-diy-lighthouses-short-answer-no)
* [12. Old-School Optical: Reflective vs Active LED Markers](#12-old-school-optical-reflective-vs-active-led-markers)
* [13. Cameras For DIY Optical](#13-cameras-for-diy-optical)
* [14. Best Webcams — Ranked](#14-best-webcams--ranked)
* [15. PS4 Camera Notes](#15-ps4-camera-notes)
* [16. How Many PS3 Eye Cameras?](#16-how-many-ps3-eye-cameras)
* [17. Ten-Camera PS3 Eye Rig — Cost](#17-ten-camera-ps3-eye-rig--cost)
* [18. Joy-Cons & PlayStation Controllers As Trackers](#18-joy-cons--playstation-controllers-as-trackers)
* [19. Building SlimeVR-Style Sensors (BNO055 → Better Options)](#19-building-slimevr-style-sensors-bno055--better-options)
* [20. Push Processing On-Sensor (Minimize Bandwidth, Max Accuracy)](#20-push-processing-on-sensor-minimize-bandwidth-max-accuracy)
* [21. Sensor Packet — What To Transmit](#21-sensor-packet--what-to-transmit)
* [22. Housing & Mounting Options](#22-housing--mounting-options)
* [23. Do 9-DoF Sensors Need Base Stations?](#23-do-9-dof-sensors-need-base-stations)
* [24. Sensor “Lifetime” (Runtime, Drift Window, Years)](#24-sensor-lifetime-runtime-drift-window-years)
* [25. Recommended Next Steps](#25-recommended-next-steps)

---

## 1. QuickMagic — What It Is

* Cloud service that turns **2D video into 3D mocap** (skeleton) using pose estimation, 3D lifting, smoothing, and retargeting.
* You can replicate most of this locally with open components; polish and edge-case handling take work.

---

## 2. ARKit (iPhone) — What It Buys You

* **Direct 3D body skeleton** in real-time (skips the heavy 2D→3D step).
* Optional **face blendshapes** (TrueDepth).
* Streams to Mac/PC; you retarget in Blender/Unreal/Unity.
* Cuts out the worst pain points of pure video-to-mocap.

---

## 3. “Video of a Video” With ARKit

* Works for quick/rough tests: ARKit will track a person shown on a monitor.
* Loses depth cues → more jitter/flip. Use only for previz, not hero capture.

---

## 4. Multi-Person Capture

* **ARKit**: single-person only.
* Solutions: capture people sequentially, use multiple iPhones, or switch to multi-person AI pipelines or optical/VR tracker systems.

---

## 5. Apple Watch As Supplement

* Acts as **extra IMUs** (wrist/arm refinement).
* Good for correcting arm/wrist rotations that ARKit guesses poorly.
* Not a full-body solution; best when **fused** with ARKit/base stations.

---

## 6. Latency Cheat Sheet

* **ARKit iPhone → skeleton**: ~40–70 ms end-to-end.
* **Apple Watch IMU → PC**: ~50–100 ms.
* **SteamVR/Lighthouses**: ~5–20 ms.
* Hybrid fusion typically lands **~80–120 ms**.

---

## 7. Base Stations (SteamVR/Vive) Basics

* “Vive base stations” **are** SteamVR lighthouses (Valve tech).
* **1.0 vs 2.0** (buy 2.0 today): larger area, up to 4 stations, tighter tracking.
* Sub-mm accuracy, low latency, scales to multi-actor.

---

## 8. Processing Load — Where The Work Actually Happens

* **ARKit pipeline**: phone does the heavy lifting; PC mostly retargets.
* **Optical DIY (webcams)**:

  * CPU/GPU: blob detection (heavy), triangulation (light), IK (medium).
  * USB controllers become a real bottleneck at scale.
* **Base stations**: low compute; the 3D app (Unreal/Blender) is the heavy part.

---

## 9. Hybrid: ARKit + Base Stations

* Track **hips/feet/hands** with lighthouses for absolute, low-latency anchors.
* Fill **spine/neck/head** with ARKit skeleton.
* Fuse in engine (Control Rig/FinalIK) → fewer pucks, better coverage.
* Calibration + time-sync is the tax.

---

## 10. SlimeVR — What It Is & Mixing With Lighthouses

* **IMU-only** full-body via ESP32 + 6/9/11 sensors; rotation-only, no absolute position.
* Combine with **headset/controllers or a few Vive trackers** to kill drift and anchor root.

---

## 11. DIY Lighthouses? (Short Answer: No)

* Hardware is complex (IR lasers + rotating optics + timing) and **patented**.
* Doable alternatives: IMU suits (SlimeVR), depth cameras, or buy used lighthouses.

---

## 12. Old-School Optical: Reflective vs Active LED Markers

* **Passive (reflective balls)**: pro-grade, expensive multi-IR camera arrays (Vicon/OptiTrack).
* **Active (LEDs)**: DIY-friendly — multiple webcams + OpenCV blob detection + triangulation.
* Active is your realistic “garage Vicon.”

---

## 13. Cameras For DIY Optical

* **IR security cams**: cheap, but low fps + compression = meh for mocap.
* **iPhones**: great cams; syncing multiple is the pain.
* **Webcams / PS Eye / PS4 cam**: cheap, high fps, huge DIY community.
* **Depth cams** (Kinect/RealSense): solid markerless complement; limited FOV/occlusion.

---

## 14. Best Webcams — Ranked

* **Budget king**: **PS3 Eye** (640×480@60 / 320×240@120), easy IR mod, $10–15 used.
* **General purpose**: **Logitech C922/C930e** (720p@60), fewer DIY mods.
* **Mid-tier**: **PS4 Camera** (1280×800@60) w/ USB adapter, fewer guides.
* **Serious DIY**: **ELP/industrial global-shutter USB** cams (60–120 fps), $50–100+.
* **Pro**: Basler/FLIR/IDS (expensive, excellent).

---

## 15. PS4 Camera Notes

* Dual lenses, 1280×800@60, requires USB adapter + community driver.
* Sharper than PS Eye; less hack-friendly than PS Eye, cheaper than industrial.

---

## 16. How Many PS3 Eye Cameras?

* **3** = bare minimum triangulation (fragile to occlusion).
* **4** = practical baseline (single actor).
* **6** = sweet spot (full-body reliability).
* **8–10** = multi-actor / studio-ish; more calibration/USB pain.

---

## 17. Ten-Camera PS3 Eye Rig — Cost

* **Cams**: $100–150
* **USB PCIe cards (bandwidth)**: $125–200
* **Mounts**: $100–150
* **Markers/LEDs**: $50–100
* **PC (if needed)**: $0–900
* **Misc**: $100–175
* **Total**: **$475–$1,675** (lower if you already have the PC)

---

## 18. Joy-Cons & PlayStation Controllers As Trackers

* **Joy-Cons**: good IMUs over Bluetooth; rotation only; pair like SlimeVR nodes.
* **PS Move**: glowing orb + IMU → excellent active optical markers with PS Eye/OpenCV.
* **DualShock/DualSense**: usable but bulky.

---

## 19. Building SlimeVR-Style Sensors (BNO055 → Better Options)

* Your pick: **BNO055** (on-chip fusion; easy, but dated).
* Better: **BNO085/BNO080** (Hillcrest SH-2 fusion; smoother, higher-rate).
* DIY fusion route: **ICM-20948** (DMP) or **BMI270+BMM150** with Madgwick/Mahony on MCU.

**Per sensor BOM (realistic):**

* BNO085: $25–40
* ESP32-S3 dev board: $6–12
* LiPo 750–1000 mAh: $8–12
* Case/strap/wiring: $5–8
* **≈ $45–70 per node**

---

## 20. Push Processing On-Sensor (Minimize Bandwidth, Max Accuracy)

* Do **fusion on the node** (BNO085 or MCU filter).
* **SPI** bus to IMU (less jitter than I²C).
* **Timestamp at read**; downsample to 100–200 Hz for radio.
* **ESP-NOW** (preferred) or UDP Wi-Fi; **avoid BLE** for this use.

---

## 21. Sensor Packet — What To Transmit

Send only the essentials — quaternion + timestamp (+ optional gyro). Fixed-point, compact.

```c
// ~20–24 bytes
struct PosePkt {
  uint32_t t_us;          // microsecond timestamp (monotonic)
  int16_t  qx, qy, qz, qw; // quaternion (Q15)
  int16_t  wx, wy, wz;     // optional: angular velocity (rad/s * 1000)
  uint8_t  id;             // sensor id
  uint8_t  flags;          // calib_ok, mag_used, fifo_overrun, etc.
};
```

**Rates:** 100–200 Hz per node. Ten nodes ≈ a few KB/s total. Trivial.

---

## 22. Housing & Mounting Options

* **3D-printed cases (PETG/ABS)** with strap slots — best all-around.
* **Off-the-shelf ABS boxes** + Velcro (bulkier, easy).
* **Soft pouches** with a stiff backing plate (comfy; watch wobble).
* **Hybrid hard-shell + sports armband** (rigid electronics, comfy wear).
* **Sewn-in garments** (pro feel; harder to service).

Key rules: rigid IMU orientation, consistent mounting, USB-C access, insulated LiPo, orientation arrow on case.

---

## 23. Do 9-DoF Sensors Need Base Stations?

* **No.** 9-DoF IMUs can run fully standalone (orientation only).
* **Tradeoff:** yaw drift over time and no true world position.
* Common hybrid: add **one absolute anchor** (lighthouse puck or UWB hip tag) to kill root drift.

---

## 24. Sensor “Lifetime” (Runtime, Drift Window, Years)

* **Per charge:** 6–10 h with 750–1000 mAh LiPo (ESP-NOW helps).
* **Drift window:** 10–20 min before noticeable yaw creep without rebias; hours with periodic stillness rebias.
* **Hardware life:** 5+ years electronics; **LiPo** 300–500 cycles (plan to replace yearly-ish under heavy use).

---

## 25. Recommended Next Steps

### A) If you want **fastest path to usable capture**

1. Use **ARKit** on iPhone for body; export & retarget in Blender/Unreal.
2. Add **Apple Watch** (optional) for wrist refinement.
3. Accept ~40–70 ms latency, single actor.

### B) If you want **IMU suit (no cameras)**

1. Build **7–9 BNO085 + ESP32-S3** nodes (hips, chest, head, shins, forearms, feet).
2. Firmware: on-node fusion, **ESP-NOW**, 100–200 Hz quats, timestamps.
3. SlimeVR server → retarget.
4. Consider **one anchor** later (lighthouse hip puck or UWB) to kill root drift.

### C) If you want **optical DIY**

1. Start with **6× PS3 Eye** cams, IR LED markers, OpenCV blob + triangulation.
2. Scale to **10 cams** if you need multi-actor.
3. Expect calibration and USB bandwidth wrangling.

### D) If you want **low-latency precision**

1. Buy **SteamVR 2.0 base stations** (2–4) + **Vive trackers** (hips/feet/hands).
2. Optionally fuse with **ARKit** (spine/head) or **IMU suit** (joints).
3. Live retarget in Unreal/Unity (Control Rig/FinalIK).

### E) Quality & comfort upgrades (any path)

* **Housings**: print PETG cases; standardize strap positions/orientation.
* **Power**: move to **hot-swappable cells** or pogo-pin charge docks.
* **Calibration**: store per-unit biases in NVS; add quick T-pose align.
* **Time sync**: implement startup beacon + rolling offset correction.

---

If you tell me which path (A/B/C/D) you want to execute first, I’ll lay down a concrete **shopping list + wiring + software checklist** so you can build it straight through with no guesswork.


id: 49751f36f7814f9cbe136f9d5d78a1cf
parent_id: 7281cae0eaec48078ff2080548ab7931
created_time: 2025-09-28T17:52:29.096Z
updated_time: 2025-09-28T18:22:08.118Z
is_conflict: 0
latitude: 30.43825590
longitude: -84.28073290
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 0
user_created_time: 2025-09-28T17:52:29.096Z
user_updated_time: 2025-09-28T17:58:26.368Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
share_id: 
conflict_original_id: 
master_key_id: 
user_data: 
deleted_time: 1759083728118
type_: 1