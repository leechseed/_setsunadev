id: ed69d6c7db474bac8b6c0ab260057604
parent_id: 158e85064a31487e910819c14d8facff
item_type: 1
item_id: fdc26baa9cc14ff69628dcc49658daea
item_updated_time: 1764786206428
title_diff: "[{\"diffs\":[[1,\"üìò Development Workflow Atomic Astrology Database ‚Äî \"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":52}]"
body_diff: "[{\"diffs\":[[1,\"# üìò Atomic Astrology Database ‚Äî Development Workflow\\\n\\\n**Category:** Data Architecture / System Design  \\\n**Focus:** Building the DB as infrastructure (not character-first)\\\n\\\n---\\\n\\\n## üìë Table of Contents\\\n\\\n1. [Objective](#1-objective)  \\\n2. [Mental Model](#2-mental-model)  \\\n3. [Phase 0 ‚Äî Stack & Ground Rules](#3-phase-0--stack--ground-rules)  \\\n   - [3.1 DB Engine](#31-db-engine)  \\\n   - [3.2 Tooling](#32-tooling)  \\\n   - [3.3 Conventions](#33-conventions)  \\\n4. [Phase 1 ‚Äî Core Meta Schema](#4-phase-1--core-meta-schema)  \\\n   - [4.1 Tables to Build First](#41-tables-to-build-first)  \\\n   - [4.2 Minimal DDL Skeleton](#42-minimal-ddl-skeleton)  \\\n5. [Phase 2 ‚Äî Seed Domains, Subsystems, Atomic Variables](#5-phase-2--seed-domains-subsystems-atomic-variables)  \\\n   - [5.1 Seeding Strategy](#51-seeding-strategy)  \\\n   - [5.2 Sanity Checks](#52-sanity-checks)  \\\n6. [Phase 3 ‚Äî Add Overlay Models (Meta Only)](#6-phase-3--add-overlay-models-meta-only)  \\\n   - [6.1 Register Models](#61-register-models)  \\\n   - [6.2 Register Dimensions](#62-register-dimensions)  \\\n7. [Phase 4 ‚Äî Wire Astro Variables to Models](#7-phase-4--wire-astro-variables-to-models)  \\\n8. [Phase 5 ‚Äî Characters, Charts & Instance Layer](#8-phase-5--characters-charts--instance-layer)  \\\n   - [8.1 Core Instance Tables](#81-core-instance-tables)  \\\n   - [8.2 Overlay & Atomic Instance Tables](#82-overlay--atomic-instance-tables)  \\\n9. [Phase 6 ‚Äî Dev Workflows & Core Queries](#9-phase-6--dev-workflows--core-queries)  \\\n   - [9.1 Must-Have Queries](#91-must-have-queries)  \\\n10. [Phase 7 ‚Äî Iteration Strategy](#10-phase-7--iteration-strategy)  \\\n11. [One-Week Implementation Plan](#11-one-week-implementation-plan)\\\n\\\n---\\\n\\\n## 1. Objective\\\n\\\n- Build a **universal astrology + psychology database** that:\\\n  - Stores **meta definitions** (domains, subsystems, atomic variables, overlay models).\\\n  - Stores **instance data** (characters, charts, overlay scores, atomic values).\\\n  - Lets you attach external models (Big Five, Enneagram, Attachment, etc.) to astro variables in a clean, scalable way.\\\n\\\nThis is **infrastructure**, not story. The goal is a stable schema you can slam thousands of characters into later.\\\n\\\n---\\\n\\\n## 2. Mental Model\\\n\\\n- **Meta vs Instance:**\\\n  - **META** = dictionary / grammar:\\\n    - `domains`, `subsystems`, `atomic_variable_def`, `overlay_model`, `overlay_model_dimension`, `atomic_variable_overlay`.\\\n  - **INSTANCE** = actual data:\\\n    - `characters`, `charts`, `overlay_model_profile`, `overlay_model_dimension_value`, `atomic_value`.\\\n\\\n- Think in 3 layers:\\\n  1. **Grammar** ‚Üí table structure + meta rows.\\\n  2. **Dictionary** ‚Üí all your atomic var definitions + model dimensions.\\\n  3. **Sentences** ‚Üí concrete character charts and values.\\\n\\\nYou do **1 & 2 first**. Characters come later.\\\n\\\n---\\\n\\\n## 3. Phase 0 ‚Äî Stack & Ground Rules\\\n\\\n### 3.1 DB Engine\\\n\\\n- Recommended:\\\n  - **PostgreSQL** if you want a long-term, flexible, JSON-friendly core.\\\n  - **SQLite** only if you want a quick single-file portable prototype.\\\n\\\n- Default assumption: **Postgres**.\\\n\\\n---\\\n\\\n### 3.2 Tooling\\\n\\\n- **DB viewer:** DBBeaver (browse tables, run queries, inspect ERD).\\\n- **Migrations:** pick one and commit to it, e.g.:\\\n  - `Flyway`, `Liquibase`, or\\\n  - ORM-based: `SQLAlchemy + Alembic`, `Prisma`, etc.\\\n\\\nRule:  \\\n- **No manual schema changes in ‚Äúreal‚Äù DB.**  \\\n- All schema edits go through migrations.\\\n\\\n---\\\n\\\n### 3.3 Conventions\\\n\\\n- **Naming:**\\\n  - Tables: `snake_case_plural` ‚Üí `domains`, `subsystems`, `atomic_variable_def`.\\\n  - PKs: `table_singular_id` ‚Üí `domain_id`, `subsystem_id`.\\\n  - Codes: `UPPER_SNAKE` ‚Üí `SUN_IDENTITY_AXIS`, `BIG_FIVE`.\\\n\\\n- **IDs:**\\\n  - Start with `SERIAL` / `BIGINT` primary keys.\\\n  - Add `uuid` later if you really need cross-system IDs.\\\n\\\n- **Separation:**\\\n  - META tables: definitions only.\\\n  - INSTANCE tables: per character/chart data only.\\\n\\\nLock this in: **do not mix meta and instance in the same table.**\\\n\\\n---\\\n\\\n## 4. Phase 1 ‚Äî Core Meta Schema\\\n\\\n### 4.1 Tables to Build First\\\n\\\nCreate these **before touching characters**:\\\n\\\n1. `domains` ‚Äì high-level psycho-astro buckets.\\\n2. `subsystems` ‚Äì Sun/Moon/Asc/Planets/Houses/etc. mapped to domains.\\\n3. `atomic_variable_def` ‚Äì all the `SUN_*`, `MOON_*`, `ASC_*`, `H*_` variables.\\\n4. `overlay_model` ‚Äì Big Five, Enneagram, Attachment, etc.\\\n5. `overlay_model_dimension` ‚Äì each trait/slider inside those models.\\\n\\\n---\\\n\\\n### 4.2 Minimal DDL Skeleton\\\n\\\nBarebones start (Postgres-flavored):\\\n\\\n```sql\\\nCREATE TABLE domains (\\\n    domain_id        SERIAL PRIMARY KEY,\\\n    domain_code      VARCHAR(64) UNIQUE NOT NULL,\\\n    name             VARCHAR(128) NOT NULL,\\\n    description      TEXT\\\n);\\\n\\\nCREATE TABLE subsystems (\\\n    subsystem_id     SERIAL PRIMARY KEY,\\\n    domain_id        INTEGER NOT NULL REFERENCES domains(domain_id),\\\n    subsystem_code   VARCHAR(64) UNIQUE NOT NULL,\\\n    name             VARCHAR(128) NOT NULL,\\\n    description      TEXT\\\n);\\\n\\\nCREATE TABLE atomic_variable_def (\\\n    atomic_var_id    SERIAL PRIMARY KEY,\\\n    subsystem_id     INTEGER NOT NULL REFERENCES subsystems(subsystem_id),\\\n    var_code         VARCHAR(128) UNIQUE NOT NULL,\\\n    name             VARCHAR(128) NOT NULL,\\\n    description      TEXT,\\\n    data_type        VARCHAR(32) NOT NULL DEFAULT 'text',\\\n    applies_to_level VARCHAR(32) NOT NULL DEFAULT 'both',\\\n    is_core          BOOLEAN NOT NULL DEFAULT TRUE\\\n);\\\n\\\nCREATE TABLE overlay_model (\\\n    model_id         SERIAL PRIMARY KEY,\\\n    domain_id        INTEGER REFERENCES domains(domain_id),\\\n    model_code       VARCHAR(64) UNIQUE NOT NULL,\\\n    name             VARCHAR(128) NOT NULL,\\\n    model_type       VARCHAR(64) NOT NULL,\\\n    description      TEXT\\\n);\\\n\\\nCREATE TABLE overlay_model_dimension (\\\n    dimension_id     SERIAL PRIMARY KEY,\\\n    model_id         INTEGER NOT NULL REFERENCES overlay_model(model_id),\\\n    dimension_code   VARCHAR(64) NOT NULL,\\\n    name             VARCHAR(128) NOT NULL,\\\n    data_type        VARCHAR(32) NOT NULL DEFAULT 'numeric',\\\n    min_value        NUMERIC,\\\n    max_value        NUMERIC,\\\n    enum_options     JSONB,\\\n    UNIQUE (model_id, dimension_code)\\\n);\\\n\"]],\"start1\":0,\"start2\":0,\"length1\":0,\"length2\":6026}]"
metadata_diff: {"new":{},"deleted":[]}
encryption_cipher_text: 
encryption_applied: 0
updated_time: 2025-12-03T18:25:29.571Z
created_time: 2025-12-03T18:25:29.571Z
type_: 13